(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{624:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("多个项目都是基于一个版本迭代开发多个版本，项目结构大致相同，为了便于管理升级而开发的cli工具\n")]),s._v(" "),a("p",[s._v("开发前，先是分析了项目的差异。虽然是基于同一个项目开发的项目，但不同项目间还是存在不同的差异，不同的项目存在着不同的差异。所以cli需要可配置 "),a("code",[s._v("ignore")]),s._v(" 目录和文件路径。"),a("br"),s._v("\n项目因为是多人维护，升级的文件可能会频繁迭代升级，所以需要一个 "),a("code",[s._v("repo")]),s._v(" 作为所有基础，通过这个 "),a("code",[s._v("repo")]),s._v(" 去维护升级项目。"),a("br"),s._v("\n工具插件页拆分放到单独的 "),a("code",[s._v("repo")]),s._v(" 上，毕竟开发间可能有不同的线上工具仓库。"),a("br"),s._v("\n综合以上，我们需要这样的一个配置文件")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" '基础仓库'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  utils"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" '工具仓库'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  ignore"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不同步更新的目录、文件路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("做好了这些，按着可能的操作进行开发。 根据自身需求预置：创建项目、升级项目、升级工具、快速模版、管理配置的指令。"),a("br"),s._v("\n利用 "),a("a",{attrs:{href:""}},[s._v("prompts")]),s._v(" 来进行交互处理输入、选择等操作。\n因为实际是在node v14上开发的，而实际环境最低需要支持到 node v10。先是对 cli的一些方法降级到低版本node能兼容执行的，"),a("code",[s._v("fsPromises")]),s._v(" 支持版本需要在 node 12.10.0+，限定cli 最低版本为 node 12.10.0.")]),s._v(" "),a("p",[s._v("cli一部分的依赖和配置")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"at-least-node"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^1.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"commander"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^7.2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"download-git-repo"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.0.2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"prompts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^2.4.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pug"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.0.2"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"engines"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" “node"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v(">="),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("开发完成的cli已发布在npm上[https://www.npmjs.com/package/@jinhome/jin-cli]，定制化内容比较多不适用于其他项目。")]),s._v(" "),a("h4",{attrs:{id:"遇到的一些坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#遇到的一些坑"}},[s._v("#")]),s._v(" 遇到的一些坑")]),s._v(" "),a("ul",[a("li",[s._v("升级拷贝文件时需要保证存在目录")]),s._v(" "),a("li",[s._v("node获取父级目录 path.resolve('../')")]),s._v(" "),a("li",[s._v("退出命令  process.exit()")]),s._v(" "),a("li",[s._v("package.json 中的 engines 只能作为参考")])]),s._v(" "),a("hr"),s._v(" "),a("h4",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("ul",[a("li",[s._v("[download-git-repo]")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://pugjs.org/zh-cn/language/attributes.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("pug 中文文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.dazhuanlan.com/2019/11/05/5dc184064e7b5/",target:"_blank",rel:"noopener noreferrer"}},[s._v("pug 教程"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.npmjs.com/package/at-least-node",target:"_blank",rel:"noopener noreferrer"}},[s._v("at-least-node"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/h5bp/html5-boilerplate/",target:"_blank",rel:"noopener noreferrer"}},[s._v("html5模板"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);