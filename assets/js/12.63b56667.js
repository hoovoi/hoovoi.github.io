(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{568:function(e,s,t){"use strict";t.r(s);var a=t(7),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"什么是cors"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是cors"}},[e._v("#")]),e._v(" 什么是CORS?")]),e._v(" "),t("p",[e._v('CORS是一个W3C标准，全称是"跨域资源共享"（Cross-origin resource sharing）。'),t("br"),e._v("\n它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。")]),e._v(" "),t("p",[e._v("CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。\n整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。\n因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信。")]),e._v(" "),t("h2",{attrs:{id:"简单请求-simple-request"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简单请求-simple-request"}},[e._v("#")]),e._v(" 简单请求 simple request")]),e._v(" "),t("ol",[t("li",[e._v("请求方式")])]),e._v(" "),t("ul",[t("li",[e._v("HEAD")]),e._v(" "),t("li",[e._v("GET")]),e._v(" "),t("li",[e._v("POST")])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("HTTP的头信息不超出")])]),e._v(" "),t("ul",[t("li",[e._v("Accept")]),e._v(" "),t("li",[e._v("Accept-Language")]),e._v(" "),t("li",[e._v("Content-Language")]),e._v(" "),t("li",[e._v("Last-Event-ID")]),e._v(" "),t("li",[e._v("Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain")])]),e._v(" "),t("h3",{attrs:{id:"浏览器处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器处理"}},[e._v("#")]),e._v(" 浏览器处理")]),e._v(" "),t("p",[e._v("发现是CORS的简单请求后，浏览器会在请求头部中增加 "),t("code",[e._v("Origin")]),e._v(" 字段, 描述请求源的信息。服务器根据此决定是否同意请求。若回应头信息不包含"),t("code",[e._v("Access-Control-Allow-Origin")]),e._v("，会抛出错误进入请求错误的事件。")]),e._v(" "),t("h3",{attrs:{id:"服务器返回的头信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务器返回的头信息"}},[e._v("#")]),e._v(" 服务器返回的头信息")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Access-Control-Allow-Origin: http://api.bob.com  \nAccess-Control-Allow-Credentials: true\nAccess-Control-Expose-Headers: FooBar\nContent-Type: text/html; charset=utf-8\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("ul",[t("li",[t("code",[e._v("Access-Control-Allow-Origin: *")]),e._v(" 服务器允许的域名白名单，"),t("code",[e._v("*")]),e._v(" 为域名所有域名")]),e._v(" "),t("li",[t("code",[e._v("Access-Control-Allow-Credentials: true")]),e._v(" 是否允许向服务器发送Cookies 值仅允许设置为ture，不允许浏览器发送cookies直接删除该字段即可")])]),e._v(" "),t("h3",{attrs:{id:"向服务器发送携带cookies的请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#向服务器发送携带cookies的请求"}},[e._v("#")]),e._v(" 向服务器发送携带Cookies的请求")]),e._v(" "),t("ol",[t("li",[e._v("请求需要设置 "),t("code",[e._v("withCredentials")]),e._v("属性")]),e._v(" "),t("li",[e._v("服务器 "),t("code",[e._v("Access-Control-Allow-Origin: http://api.com")]),e._v(" 必须为具体的域名，不能为"),t("code",[e._v("*")])])]),e._v(" "),t("hr"),e._v(" "),t("h2",{attrs:{id:"非简单请求-not-so-simple-request"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非简单请求-not-so-simple-request"}},[e._v("#")]),e._v(" 非简单请求 not-so-simple request")]),e._v(" "),t("p",[e._v("不满足"),t("em",[e._v("简单请求")]),e._v("条件的都是非简单请求。"),t("br"),e._v("\n浏览器为向发出一个类型 "),t("code",[e._v("options")]),e._v(" 的预检请求（preflight）")]),e._v(" "),t("p",[e._v("请求头部：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("Access-Control-Request-Method")]),e._v(" 描述HTTP会使用到的方法（POST、GET、PUT)")]),e._v(" "),t("li",[t("code",[e._v("Access-Control-Request-Headers")]),e._v(" 用逗号隔开个字符串，描述请求额外发送的头部信息（ 自定义的头部字段信 ）")])]),e._v(" "),t("p",[e._v("返回头部：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("Access-Control-Allow-Methods: GET, POST, PUT")]),e._v(' 字段必需，它的值是逗号分隔的一个字符串，表明服务器支持的所有跨域请求的方法。注意，返回的是所有支持的方法，而不单是浏览器请求的那个方法。这是为了避免多次"预检"请求。')]),e._v(" "),t("li",[t("code",[e._v("Access-Control-Allow-Headers: X-Custom-Header")]),e._v(' 如果浏览器请求包括Access-Control-Request-Headers字段，则Access-Control-Allow-Headers字段是必需的。它也是一个逗号分隔的字符串，表明服务器支持的所有头信息字段，不限于浏览器在"预检"中请求的字段。')]),e._v(" "),t("li",[t("code",[e._v("Access-Control-Allow-Credentials: true")]),e._v(" 是否允许携带Cookies")]),e._v(" "),t("li",[t("code",[e._v("Access-Control-Max-Age: 1728000")]),e._v(" 字段可选，用来指定本次预检请求的有效期，单位为秒。上面结果中，有效期是20天（1728000秒），即允许缓存该条回应1728000秒（即20天），在此期间，不用发出另一条预检请求。")])]),e._v(" "),t("p",[e._v("预检请求通过后，浏览器发起的CORS请求。")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("PUT /cors HTTP/1.1\nOrigin: http://api.bob.com  // 浏览器自动添加\nHost: api.alice.com\nX-Custom-Header: value\nAccept-Language: en-US\nConnection: keep-alive\nUser-Agent: Mozilla/5.0...\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("hr"),e._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),t("ul",[t("li",[e._v("[http://www.ruanyifeng.com/blog/2016/04/cors.html]")]),e._v(" "),t("li",[e._v("[https://mp.weixin.qq.com/s/AeZPqgU9Y6yXbwVbUrRdWw]")]),e._v(" "),t("li",[e._v("[https://blog.huli.tw/2021/02/19/cors-guide-3/]")])])])}),[],!1,null,null,null);s.default=r.exports}}]);